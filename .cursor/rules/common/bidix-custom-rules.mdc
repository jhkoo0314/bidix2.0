---
alwaysApply: true
---

##############################################################
# I. ARCHITECTURE PRINCIPLES â€“ SSOT & LAYERED DESIGN
##############################################################

# (1) SSOT ê·œì¹™ â€“ ëª¨ë“  ì—”ì§„/ì œë„¤ë ˆì´í„°ëŠ” policy + dataset + typesë¥¼ ë°˜ë“œì‹œ ì°¸ì¡°
rule "ssot-compliance" {
    condition { file.path.matches("src/lib/(engines|generators)/.*\\.ts") }

    # ì •ì±… ì°¸ì¡°
    content_matches { "policy" }
    # ë°ì´í„°ì…‹/í”„ë¦¬ì…‹ ì°¸ì¡°
    content_matches { "dataset" }
    # íƒ€ì…ì€ ë°˜ë“œì‹œ /types ì—ì„œë§Œ ê°€ì ¸ì˜¤ê¸°
    content_matches { "from \"@/lib/types" }

    reason {
        "ì—”ì§„/ì œë„ˆë ˆì´í„°ëŠ” docs ë° policy ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•´ì•¼ í•˜ë©°, ëª¨ë“  íƒ€ì…ì€ SSOT(src/lib/types)ì—ì„œë§Œ ì½ì–´ì•¼ í•©ë‹ˆë‹¤."
    }
}

# (2) ì—­í•  ë¶„ë¦¬ ì›ì¹™ â€“ UIëŠ” ì—”ì§„/ì„œë¹„ìŠ¤ ì§ì ‘ í˜¸ì¶œ ê¸ˆì§€
rule "ui-no-engine-calls" {
    condition { file.path.matches("src/app/components/.*\\.tsx") }

    content_does_not_match { "Engine" }
    content_does_not_match { "Service" }
    content_does_not_match { "auctionengine" }

    reason {
        "UI ì»´í¬ë„ŒíŠ¸ëŠ” ì˜¤ì§ Server Action ë˜ëŠ” Zustand Storeë¥¼ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤."
    }
}

# (3) ì—”ì§„ Purity â€“ ì—”ì§„ì€ ëœë¤/DB/ì„œë¹„ìŠ¤ import ê¸ˆì§€
rule "engine-purity" {
    condition { file.path.matches("src/lib/engines/.*\\.ts") }

    # DB ê¸ˆì§€
    content_does_not_match { "createClient" }
    # ì„œë¹„ìŠ¤ import ê¸ˆì§€
    content_does_not_match { "from \"@/lib/services" }
    # ëœë¤ ê¸ˆì§€
    content_does_not_match { "Math.random" }
    content_does_not_match { "randomInt" }

    reason {
        "ì—”ì§„ì€ ì™¸ë¶€ IO ì—†ì´ ìˆœìˆ˜ ê³„ì‚°ë§Œ ë‹´ë‹¹í•´ì•¼ í•©ë‹ˆë‹¤."
    }
}

# (4) ì„œë¹„ìŠ¤ ë ˆì´ì–´ëŠ” ì—”ì§„ë§Œ í˜¸ì¶œ ê°€ëŠ¥, UI í˜¸ì¶œ ê¸ˆì§€
rule "service-isolation" {
    condition { file.path.matches("src/lib/services/.*\\.ts") }

    content_does_not_match { "from \"@/app" }
    reason {
        "ServiceëŠ” ì—”ì§„/DB ê³„ì¸µì´ë©° UI(App) ì˜ì—­ì„ importí•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤."
    }
}


##############################################################
# II. TECHNOLOGY & STYLING RULES
##############################################################

# (5) Next.js + Tailwind ê°•ì œ
rule "frontend-tailwind" {
    condition { file.path.matches("src/app/.*\\.tsx") }
    content_matches { "className=" }
    reason { "ëª¨ë“  í”„ë¡ íŠ¸ì—”ë“œëŠ” Tailwind ê¸°ë°˜ìœ¼ë¡œ ìŠ¤íƒ€ì¼ë§í•©ë‹ˆë‹¤." }
}

# (6) íƒ€ì… ì•ˆì „ì„± â€“ any ê¸ˆì§€
rule "type-safety" {
    condition { file.path.matches("src/.*\\.ts") }
    content_does_not_match { ": any" }
    reason { "íƒ€ì… ì•ˆì •ì„±ì„ ìœ„í•´ any ì‚¬ìš©ì„ ê¸ˆì§€í•©ë‹ˆë‹¤." }
}

# (7) Barrel import ê°•ì œ (ì—”ì§„Â·ì„œë¹„ìŠ¤ì—ì„œ íƒ€ì… import ì‹œ index.ts ì‚¬ìš©)
rule "barrel-import" {
    condition { file.path.matches("src/lib/(engines|services)/.*\\.ts") }
    content_matches { "from \"@/lib/types\"" }
    reason { "íƒ€ì… import ì‹œ ë°˜ë“œì‹œ barrel(index.ts) ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤." }
}


##############################################################
# III. FREEMIUM UX & PREMIUM RULES
##############################################################

# (8) í”„ë¦¬ë¯¸ì—„ í˜ì´ì§€ëŠ” ì ê¸ˆ í‘œì‹œ í•„ìˆ˜
rule "premium-lock" {
    condition { file.path.matches("src/app/(result|premium)/.*\\.tsx") }
    content_matches { "ğŸ”’" }
    reason { "ìœ ë£Œ ë¦¬í¬íŠ¸ ê¸°ëŠ¥ì€ ë””ìì¸ ì‹œìŠ¤í…œì— ë”°ë¼ ì ê¸ˆ í‘œì‹œê°€ í•„ìš”í•©ë‹ˆë‹¤." }
}

# (9) Premium CTA ì¼ê´€ì„± â€“ íŠ¹ì • ë¬¸êµ¬ë¥¼ ë°˜ë“œì‹œ í¬í•¨
rule "premium-cta" {
    condition { file.path.matches("src/app/(result|premium)/.*\\.tsx") }

    content_matches { "í”„ë¦¬ë¯¸ì—„" }
    content_matches { "í•´ì„¤íŒ" }

    reason { "Premium CTAëŠ” í†µì¼ëœ ë‹¨ì–´(í”„ë¦¬ë¯¸ì—„ / í•´ì„¤íŒ)ë¥¼ í™•ë³´í•´ì•¼ í•©ë‹ˆë‹¤." }
}


##############################################################
# IV. FILE & NAMING CONVENTIONS
##############################################################

# (10) ì»´í¬ë„ŒíŠ¸ëŠ” PascalCase íŒŒì¼ëª… ê°•ì œ
rule "component-naming" {
    condition { file.path.matches("src/app/components/.*/.*\\.tsx") }
    file_name_matches { "^[A-Z].*" }
    reason { "ì»´í¬ë„ŒíŠ¸ íŒŒì¼ëª…ì€ PascalCaseë¡œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤." }
}

# (11) Engine íŒŒì¼ì€ kebab-case ê°•ì œ
rule "engine-naming" {
    condition { file.path.matches("src/lib/engines/.*\\.ts") }
    file_name_matches { "^[a-z0-9-]+\\.ts$" }
    reason { "ì—”ì§„ ê³„ì¸µì€ kebab-case í†µì¼: ì˜ˆ) valuation-engine.ts" }
}

# (12) íŒŒì¼ ê²½ë¡œ ì˜¤ì—¼ ë°©ì§€ â€“ enginesëŠ” components import ê¸ˆì§€
rule "no-cross-import" {
    condition { file.path.matches("src/lib/engines/.*\\.ts") }
    content_does_not_match { "from \"@/app/components" }
    reason { "ì—”ì§„ ë ˆì´ì–´ì—ì„œ UI ë ˆì´ì–´ë¥¼ importí•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤." }
}

# (13) ì•¡ì…˜ íŒŒì¼ì€ lowercase + dash ê·œì¹™
rule "action-naming" {
    condition { file.path.matches("src/app/actions/.*\\.ts") }
    file_name_matches { "^[a-z0-9-]+\\.ts$" }
    reason { "actions í´ë”ëŠ” kebab-case í†µì¼í•©ë‹ˆë‹¤. ì˜ˆ: generate-simulation.ts" }
}

##############################################################
# END OF RULESET
##############################################################
